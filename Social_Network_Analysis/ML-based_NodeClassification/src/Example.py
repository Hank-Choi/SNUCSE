import torch
import os.path as osp
import torch.nn.functional as F
from torch.nn import ModuleList
from torch_geometric.datasets import KarateClub
from torch_geometric.datasets import Planetoid
import torch_geometric.transforms as T
from torch_geometric.nn import GCNConv, ChebConv  # noq
from torch_geometric.utils import convert
import matplotlib.pyplot as plt
from sklearn.manifold import TSNE
import networkx as nx

dataset = 'Cora'
path = osp.join(osp.dirname(osp.realpath(__file__)), '..', 'data', dataset)
dataset = Planetoid(path, dataset, transform=T.TargetIndegree())
data = dataset[0]
G = convert.to_networkx(data)

colors = [
    '#ffc0cb', '#bada55', '#008080', '#420420', '#7fe5f0', '#065535', '#ffd700'
]
co = []
b = ['c3', 'c2', 'c2', 'c2', 'c2', 'c0', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c3', 'c2', 'c2', 'c2', 'c2', 'c1', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c0', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c4', 'c1', 'c1', 'c1', 'c1', 'c1', 'c3', 'c6', 'c4', 'c4', 'c4', 'c4', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c0', 'c2', 'c1', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c6', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c5', 'c5', 'c5', 'c5', 'c5', 'c5', 'c2', 'c2', 'c2', 'c2', 'c2', 'c6', 'c6', 'c3', 'c0', 'c0', 'c6', 'c0', 'c5', 'c0', 'c0', 'c3', 'c3', 'c0', 'c0', 'c6', 'c6', 'c6', 'c3', 'c3', 'c3', 'c3', 'c1', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c4', 'c3', 'c1', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c5', 'c5', 'c5', 'c5', 'c0', 'c5', 'c5', 'c5', 'c2', 'c2', 'c2', 'c3', 'c4', 'c3', 'c4', 'c3', 'c3', 'c2', 'c5', 'c5', 'c0', 'c6', 'c6', 'c5', 'c5', 'c5', 'c5', 'c6', 'c3', 'c3', 'c0', 'c3', 'c1', 'c1', 'c3', 'c1', 'c6', 'c5', 'c6', 'c6', 'c6', 'c6', 'c6', 'c0', 'c0', 'c3', 'c0', 'c0', 'c0', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c4', 'c4', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c4', 'c4', 'c5', 'c5', 'c5', 'c5', 'c3', 'c5', 'c5', 'c5', 'c5', 'c5', 'c5', 'c4', 'c4', 'c4', 'c0', 'c3', 'c4', 'c4', 'c4', 'c6', 'c6', 'c6', 'c6', 'c6', 'c0', 'c5', 'c5', 'c5', 'c0', 'c5', 'c3', 'c0', 'c0', 'c3', 'c3', 'c3', 'c1', 'c3', 'c1', 'c3', 'c3', 'c3', 'c6', 'c3', 'c3', 'c1', 'c6', 'c1', 'c4', 'c3', 'c4', 'c3', 'c3', 'c3', 'c3', 'c3', 'c6', 'c0', 'c3', 'c0', 'c0', 'c0', 'c0', 'c0', 'c0', 'c0', 'c6', 'c0', 'c0', 'c6', 'c0', 'c0', 'c6', 'c1', 'c3', 'c6', 'c5', 'c6', 'c6', 'c4', 'c4', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c4', 'c3', 'c3', 'c3', 'c4', 'c1', 'c1', 'c5', 'c1', 'c0', 'c6', 'c0', 'c0', 'c0', 'c0', 'c0', 'c0', 'c0', 'c2', 'c3', 'c5', 'c5', 'c5', 'c3', 'c3', 'c3', 'c3', 'c3', 'c0', 'c6', 'c6', 'c0', 'c0', 'c0', 'c0', 'c3', 'c3', 'c3', 'c1', 'c1', 'c1', 'c1', 'c1', 'c2', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c3', 'c1', 'c1', 'c1', 'c1', 'c1', 'c5', 'c5', 'c0', 'c6', 'c6', 'c3', 'c3', 'c5', 'c1', 'c1', 'c1', 'c4', 'c6', 'c6', 'c6', 'c6', 'c2', 'c3', 'c3', 'c0', 'c3', 'c3', 'c4', 'c4', 'c4', 'c4', 'c4', 'c4', 'c4', 'c4', 'c4', 'c4', 'c4', 'c4', 'c0', 'c6', 'c0', 'c6', 'c6', 'c3', 'c1', 'c1', 'c3', 'c3', 'c3', 'c3', 'c1', 'c1', 'c1', 'c6', 'c3', 'c6', 'c6', 'c2', 'c6', 'c3', 'c6', 'c6', 'c6', 'c0', 'c6', 'c6', 'c6', 'c6', 'c6', 'c3', 'c3', 'c6', 'c6', 'c6', 'c2', 'c2', 'c3', 'c5', 'c0', 'c0', 'c6', 'c6', 'c3', 'c3', 'c3', 'c0', 'c0', 'c0', 'c0', 'c0', 'c6', 'c5', 'c5', 'c0', 'c4', 'c6', 'c0', 'c6', 'c4', 'c6', 'c2', 'c2', 'c5', 'c0', 'c0', 'c0', 'c0', 'c0', 'c0', 'c0', 'c0', 'c4', 'c4', 'c4', 'c3', 'c5', 'c6', 'c1', 'c1', 'c3', 'c3', 'c3', 'c3', 'c3', 'c6', 'c1', 'c0', 'c2', 'c2', 'c4', 'c4', 'c4', 'c4', 'c4', 'c5', 'c0', 'c3', 'c3', 'c3', 'c0', 'c1', 'c2', 'c5', 'c4', 'c4', 'c4', 'c4', 'c4', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c4', 'c4', 'c4', 'c1', 'c1', 'c4', 'c1', 'c6', 'c5', 'c3', 'c3', 'c3', 'c4', 'c0', 'c4', 'c4', 'c4', 'c5', 'c0', 'c0', 'c3', 'c5', 'c5', 'c5', 'c5', 'c5', 'c0', 'c5', 'c0', 'c0', 'c6', 'c2', 'c6', 'c5', 'c6', 'c3', 'c5', 'c5', 'c5', 'c5', 'c5', 'c4', 'c4', 'c3', 'c3', 'c6', 'c4', 'c6', 'c3', 'c5', 'c5', 'c5', 'c1', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c2', 'c3', 'c4', 'c3', 'c0', 'c0', 'c3', 'c1', 'c3', 'c6', 'c3', 'c1', 'c1', 'c1', 'c0', 'c1', 'c5', 'c1', 'c1', 'c1', 'c1', 'c1', 'c1', 'c0', 'c1', 'c4', 'c0', 'c2', 'c4', 'c4', 'c3', 'c1', 'c1', 'c1', 'c6', 'c6', 'c3', 'c3', 'c4', 'c4', 'c0', 'c4', 'c4', 'c0', 'c4', 'c4', 'c4', 'c4', 'c0', 'c0', 'c0', 'c4', 'c2', 'c3', 'c3', 'c4', 'c5', 'c0', 'c2', 'c2', 'c3', 'c3', 'c3', 'c3', 'c3', 'c2', 'c0', 'c5', 'c5', 'c4', 'c2', 'c4', 'c3', 'c4', 'c3', 'c4', 'c4', 'c3', 'c3', 'c4', 'c4', 'c6', 'c2', 'c2', 'c2', 'c2', 'c4', 'c0', 'c0', 'c6', 'c0', 'c3', 'c4', 'c4', 'c4', 'c3', 'c3', 'c0', 'c5', 'c3', 'c5', 'c0', 'c3', 'c3', 'c3', 'c3', 'c2', 'c3', 'c2', 'c3', 'c3', 'c0', 'c0', 'c3', 'c2', 'c6', 'c6', 'c2', 'c0', 'c0', 'c1', 'c1', 'c1', 'c6', 'c4', 'c4', 'c5', 'c4', 'c4', 'c6', 'c1', 'c1', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c2', 'c5', 'c2', 'c2', 'c2', 'c0', 'c6', 'c6', 'c2', 'c6', 'c6', 'c2', 'c2', 'c6', 'c5', 'c4', 'c4', 'c4', 'c2', 'c0', 'c0', 'c2', 'c2', 'c3', 'c4', 'c4', 'c4', 'c3', 'c2', 'c3', 'c1', 'c6', 'c6', 'c5', 'c1', 'c0', 'c0', 'c6', 'c3', 'c1', 'c1', 'c4', 'c4', 'c5', 'c2', 'c3', 'c1', 'c3', 'c4', 'c5', 'c4', 'c0', 'c3', 'c3', 'c1', 'c2', 'c1', 'c1', 'c5', 'c2', 'c3', 'c3', 'c6', 'c0', 'c2', 'c3', 'c2', 'c2', 'c5', 'c3', 'c4', 'c3', 'c4', 'c4', 'c2', 'c2', 'c4', 'c2', 'c4', 'c5', 'c5', 'c3', 'c2', 'c3', 'c1', 'c0', 'c3', 'c3', 'c4', 'c5', 'c4', 'c3', 'c3', 'c3', 'c1', 'c3', 'c0', 'c5', 'c2', 'c4', 'c4', 'c4', 'c3', 'c3', 'c3', 'c1', 'c2', 'c3', 'c2', 'c2', 'c2', 'c3', 'c2', 'c2', 'c3', 'c4', 'c4', 'c2', 'c2', 'c2', 'c3', 'c2', 'c2', 'c2', 'c2', 'c3', 'c3', 'c0', 'c0', 'c4', 'c3', 'c3', 'c3', 'c2', 'c3', 'c4', 'c2', 'c2', 'c2', 'c4', 'c3', 'c4', 'c4', 'c1', 'c5', 'c3', 'c6', 'c3', 'c2', 'c2', 'c1', 'c3', 'c2', 'c2', 'c0', 'c0', 'c6', 'c3', 'c2', 'c2', 'c6', 'c2', 'c3', 'c5', 'c2', 'c3', 'c2', 'c4', 'c2', 'c5', 'c4', 'c4', 'c0', 'c5', 'c6', 'c6', 'c3', 'c3', 'c3', 'c2', 'c5', 'c3', 'c3', 'c4', 'c3', 'c3', 'c3', 'c3', 'c3', 'c4', 'c6', 'c6', 'c4', 'c2', 'c2', 'c2', 'c5', 'c4', 'c4', 'c4', 'c4', 'c5', 'c3', 'c2', 'c2', 'c5', 'c2', 'c2', 'c2', 'c2', 'c2', 'c3', 'c4', 'c4', 'c4', 'c3', 'c1', 'c4', 'c4', 'c3', 'c3', 'c6', 'c4', 'c4', 'c4', 'c4', 'c4', 'c4', 'c1', 'c4', 'c4', 'c4', 'c6', 'c4', 'c4', 'c4', 'c4', 'c2', 'c3', 'c3', 'c3', 'c2', 'c3', 'c2', 'c6', 'c3', 'c4', 'c4', 'c4', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c3', 'c2', 'c1', 'c3', 'c3']
print(b[0:3])
for a in data.y.cpu():
    co += [colors[a]]

fig = plt.figure(figsize=(8, 8))
pos = nx.spring_layout(G)
im = nx.draw_networkx_nodes(G, pos, node_color=co, node_size=10)
nx.draw_networkx_edges(G, pos)

plt.show(block=False)
